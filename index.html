<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BTME Map Explorer</title>
    <style>
      /* Loading fallback styles - will be overridden by app CSS */
      body { margin: 0; background: #1a1a2e; color: #e4e4e7; font-family: sans-serif; }
      #loading-fallback {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        text-align: center;
        padding: 20px;
      }
      #loading-fallback h1 { color: #3388ff; margin-bottom: 1rem; }
      #loading-fallback p { color: #a1a1aa; max-width: 600px; }
      .spinner {
        width: 40px; height: 40px; margin: 20px;
        border: 4px solid #374151; border-top-color: #3388ff;
        border-radius: 50%; animation: spin 1s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }
    </style>
  </head>
  <body>
    <div id="root">
      <!-- Loading fallback - will be replaced by React -->
      <div id="loading-fallback">
        <h1>BTME Map Explorer</h1>
        <div class="spinner"></div>
        <p>Loading application...</p>
        <noscript>
          <p style="color: #dc3545; margin-top: 20px;">
            JavaScript is required to run this application. Please enable JavaScript and reload the page.
          </p>
        </noscript>
      </div>
    </div>
    <script>
      // Debug: Track loading progress and catch all errors
      console.log('[Boot] HTML loaded, waiting for main module');
      window.__appLoaded = false;

      function showError(title, message, details) {
        var fallback = document.getElementById('loading-fallback');
        if (fallback) {
          fallback.innerHTML = '<h1 style="color:#dc3545">' + title + '</h1>' +
            '<p>' + message + '</p>' +
            (details ? '<pre style="background:#0f3460;padding:10px;border-radius:4px;text-align:left;overflow:auto;max-width:90%;font-size:12px">' + details + '</pre>' : '') +
            '<p style="margin-top:20px;font-size:0.9em;color:#a1a1aa">Try refreshing the page or clearing your browser cache.</p>';
        }
      }

      // Catch synchronous errors
      window.addEventListener('error', function(e) {
        console.error('[Boot] Script error:', e.message, e.filename, e.lineno);
        showError('Error Loading App', 'A script error occurred:', e.message + '\nFile: ' + (e.filename || 'unknown') + ':' + e.lineno);
      });

      // Catch Promise rejections
      window.addEventListener('unhandledrejection', function(e) {
        console.error('[Boot] Unhandled rejection:', e.reason);
        showError('Error Loading App', 'An async error occurred:', String(e.reason));
      });

      // Timeout: if app hasn't loaded in 15 seconds, show error
      setTimeout(function() {
        if (!window.__appLoaded) {
          console.error('[Boot] Timeout: App did not load within 15 seconds');
          showError('Loading Timeout', 'The application is taking too long to load.',
            'This could be due to:\n- Slow network connection\n- JavaScript file failed to load\n- Browser blocking the script');
        }
      }, 15000);
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
